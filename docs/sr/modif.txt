âœ… Modifications Ã  apporter au fichier scoring.ts
1. Ajouter les imports nÃ©cessaires en haut du fichier
typescript
123
// ===== IMPORTS S/R =====
import type { OHLC, SupportResistanceAnalysis } from "../../types";
import { analyzeSupportResistance } from "./support-resistance"; // Module sÃ©parÃ© (voir plus bas)
2. Ajouter la fonction de scoring S/R (corrigÃ©e et optimisÃ©e)
typescript
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990
// ===== SCORE SUPPORT / RESISTANCE =====

/**
 * Score S/R avec dÃ©tection de cassure et pondÃ©ration multi-timeframe
 * @returns { score: number, breakdown: object, flags: string[] }
 */
export function scoreSupportResistance(
  dailyOhlc: OHLC[],
  weeklyOhlc: OHLC[],
  price: number,

3. Modifier computeTechnicalScore() pour intÃ©grer le S/R
typescript
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667
// ===== SCORE TECHNIQUE COMPLET (VERSION AMÃ‰LIORÃ‰E) =====

export function computeTechnicalScore(
  dailyCloses: number[],
  dailyHighs: number[],
  dailyLows: number[],
  weeklyCloses: number[],
  price: number,
  regime: string,
  dailyOhlc: OHLC[],   // ðŸ”´ NOUVEAU PARAMÃˆTRE

ðŸ”§ Module support-resistance.ts optimisÃ© (Ã  crÃ©er dans le mÃªme dossier)
typescript
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798
// support-resistance.ts
import type { OHLC, SupportResistanceAnalysis, SupportResistanceLevel } from "../../types";
import { SUPPORT_RESISTANCE } from "../../constants";

// âœ… CORRECTION CRITIQUE : dÃ©tection O(n) au lieu de O(nÂ²)
export function detectSwingPoints(
  ohlc: OHLC[],
  minBars: number = SUPPORT_RESISTANCE.MIN_SWING_BARS,
): Array<{ price: number; type: "HIGH" | "LOW"; index: number; volume: number }> {
  const swings: Array<{ price: number; type: "HIGH" | "LOW"; index: number; volu
ðŸ“Œ Modifications nÃ©cessaires dans analyzeSymbol() (appelant)
Dans votre fichier principal analyzer.ts, modifiez l'appel Ã  computeTechnicalScore :
typescript
12345678910111213141516171819202122
// AVANT
const { rawScore, breakdown, riskFlags, ...rest } = computeTechnicalScore(
  dailyCloses,
  dailyHighs,
  dailyLows,
  weeklyCloses,
  price,
  regime,
);


Et ajoutez supportResistance au rapport final :
typescript
12345678910
return {
  symbol,
  timestamp: new Date(),
  // ... autres champs
  supportResistance, // ðŸ”µ Nouveau champ dans le rapport
  details: {
    // ... existant
    supportResistance: supportResistance?.daily, // Pour affichage rapide
  },
};
âœ… Pourquoi cette intÃ©gration fonctionne
CritÃ¨re
Solution apportÃ©e
Performance
Swing detection O(n) au lieu de O(nÂ²) â†’ viable sur 10k+ candles
PrÃ©cision
daysAgo basÃ© sur timestamp rÃ©el â†’ pondÃ©ration rÃ©cence correcte
Contexte
Scoring S/R dÃ©pend de action (BUY/SELL) â†’ Ã©vite les signaux contradictoires
Cassures
DÃ©tection isBroken â†’ transforme un support cassÃ© en signal baissier
ModularitÃ©
DÃ©tection S/R dans module sÃ©parÃ© â†’ respect de votre architecture
Transparence
Flags explicites (NEAR_SUPPORT_DAILY, GAP_STRENGTH_WEEKLY)
ðŸš€ RÃ©sultat dans le rapport final
json
123456789101112131415161718192021222324
{
  "score": 68,
  "action": "STRONG BUY",
  "supportResistance": {
    "daily": {
      "nearestSupport": { "price": 182.45, "strength": 87, "isBroken": false },
      "nearestResistance": { "price": 195.20, "strength": 92, "isBroken": true },
      "gapStrength": 84,
      "gapDirection": "BULLISH",
      "interpretation": "ðŸš€ RÃ©sistance 195.20 cassÃ©e avec volume â†’ zone vide jusqu'Ã  215.80 (+10.5%). Momentum haussier confirmÃ©."

Cette intÃ©gration transforme votre analyse de purement indicatrice (RSI/MACD) vers une analyse structurelle qui comprend oÃ¹ le prix se situe dans l'architecture du marchÃ© â€” Ã©lÃ©ment critique pour la gestion du risque et le timing d'entrÃ©e.